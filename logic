âœ… Add this function (right after _get_sharepoint_files):
from fastapi import Query

@router.get("/api/sharepoint-files")
def list_sharepoint_files():
    return _get_sharepoint_files(limit=None)  # will return all files

