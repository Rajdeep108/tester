# 6) if intent is "explain_features", process full docs with summarization pipeline
if intent == "explain_features":
    answer = extract_features_from_doc(all_docs, request.question)
else:
    # Fallback to limited context for other intents
    MAX_CHUNKS = 20
    selected = all_docs[:MAX_CHUNKS]
    context = "\n\n".join([doc for doc, _meta in selected])

    prompt_input = f"Intent: {intent}\n\nQuery: {request.question}\n\nContext:\n{context}"
    result = rag_chain.invoke({"input": prompt_input})
    answer = result["answer"]
