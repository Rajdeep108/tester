import docx2txt
import textract  # for legacy .doc files

def read_docx(file_path: str) -> str:
    """
    Extract all text from a .docx file, including cover pages.
    docx2txt is better than python-docx for tables, headers, and formatted text.
    """
    try:
        text = docx2txt.process(file_path) or ""
        return text
    except Exception as e:
        print(f"Error reading .docx file: {e}")
        return ""


def read_doc(file_path: str) -> str:
    """
    Extract all text from a legacy .doc file.
    textract uses antiword or other backends to read old Word files.
    """
    try:
        text = textract.process(file_path).decode("utf-8")
        return text
    except Exception as e:
        print(f"Error reading .doc file: {e}")
        return ""
