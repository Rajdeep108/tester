from langchain_chroma import Chroma

def get_filtered_retriever(filters: dict = None, persist_dir: str = PATH_TO_VECTORSTORE):
    """
    Returns a Chroma retriever that only fetches documents matching the provided metadata.
    Example filters:
        {"standard_name": "3GPP TR 23.700-67", "standard_version": "V1.0.0"}
    """
    vectordb = Chroma(
        collection_name="standards_collection",
        embedding_function=embeddings,
        persist_directory=persist_dir,
    )

    return vectordb.as_retriever(
        search_kwargs={"k": 3},
        filter=filters if filters else None
    )
