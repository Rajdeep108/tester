@router.get("/api/sharepoint-file-content")
def get_file_content(filename: str = Query(...)):
    file_path = os.path.join(SHAREPOINT_DIR, filename)
    if not os.path.isfile(file_path):
        return {"error": "File not found"}

    ext = os.path.splitext(file_path)[1].lower()
    if ext == ".docx":
        content = read_docx(file_path)
    elif ext == ".doc":
        content = read_doc(file_path)
    else:
        return {"error": "Unsupported file type"}

    return {
        "filename": filename,
        "content": content
    }



useEffect(() => {
  if (!viewerFilename) return;

  setViewerContent("Loading content...");
  fetch(`http://localhost:8000/api/sharepoint-file-content?filename=${encodeURIComponent(viewerFilename)}`)
    .then(res => res.json())
    .then(data => setViewerContent(data.content || "No content available."))
    .catch(err => setViewerContent("Failed to load content."));
}, [viewerFilename]);
