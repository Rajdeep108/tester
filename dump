@router.get("/api/open-file/{filename}")
async def open_file(filename: str):
    """Endpoint to 'open' a file using the default program (MS Word)"""
    print(f"üîç Looking for file: {filename}")  # Debug log
    
    try:
        # Security: Basic check to prevent directory traversal
        if ".." in filename or "/" in filename or "\\" in filename:
            raise HTTPException(status_code=400, detail="Invalid filename")
            
        file_path = os.path.join(SHAREPOINT_DIR, filename)
        print(f"üìÅ Full path: {file_path}")  # Debug log
        
        if not os.path.isfile(file_path):
            # Let's see what files ARE in the directory
            files_in_dir = os.listdir(SHAREPOINT_DIR)
            print(f"üìÇ Files in directory: {files_in_dir}")  # Debug log
            raise HTTPException(status_code=404, detail="File not found")
        
        print(f"‚úÖ File found, opening: {file_path}")  # Debug log
        # This opens the file on the SERVER's machine (your PC)
        success = open_file_in_os(file_path)
        
        if success:
            return {"message": f"Opening {filename}"}
        else:
            raise HTTPException(status_code=500, detail="Failed to open file")
            
    except HTTPException:
        raise
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))
